<!DOCTYPE html>
<html>
<head>
    <!--Import Google Icon Font-->
    <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="/static/css/style.css" rel="stylesheet">
    <!--Let browser know website is optimized for mobile-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/css/materialize.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
</head>


<script>

    var askarray = [];
    var bidarray = [];
    var spreadarray = [];

    var serversocket = new WebSocket("ws://localhost:8080/claim_info_ws/{{.Id}}");

    serversocket.onopen = function() {
        serversocket.send("Connection init");
    }

    // Write message on receive
    serversocket.onmessage = function(e) {

        jsonData = e.data;

        var obj = JSON.parse(jsonData);

        var ispaid = obj.paid;
        var isactive = obj.active;
            if (ispaid) {
                $(".paymentsuccess_overlay").fadeIn(100);
            }
    }


</script>

<body class="blue-grey lighten-4">

<div class="row">
    <div class="col s6 offset-s3 blue-grey lighten-5">
        <h5>Record ID #{{.Id}}</h5>

        <div class="qrcodepayment"><img src="/{{.QRcodeFile}}">
            <div class="paymentsuccess_overlay" {{if .Paid}} style="display: block" {{end}}>
                <i class="large material-icons">verified_user</i>
            </div>
        </div>

        Pay exactly {{.Amount}} to Bitcoin Address {{.Wallet}} for this record to become active.<br>
        Scan QRcode or <a href="bitcoin:{{.Wallet}}?amount={{.Amount}}">Click Here To Pay</a>



        {{if .TransactionId}}
        <p>Transaction ID: <a target="_blank" href="https://blockchain.info/tx/{{.TransactionId}}">{{.TransactionId}}</a>
        {{end}}

        {{if .Active}}
        <p>This transaction had been paid in full and is ready for receiver to claim.
        {{end}}

        {{if .Locked}}
        This claim is currently Locked.
        {{end}}

</div>

</div>










<!--Import jQuery before materialize.js-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<!-- Compiled and minified JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/js/materialize.min.js"></script>
</body>
</html>
